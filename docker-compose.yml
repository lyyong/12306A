version: '3.5'
services:
  pay-server:
    build:
      context: ./server/pay
      labels:
        - "latest"
    ports:
      - "8082:8082"
  candidate-server:
    build:
      context: ./server/candidate
      labels:
        - "latest"
    ports:
      - "8102:8102"
  mysql:
    ports:
      - "3310:3306"
    volumes:
      - "~/data/docker-mysql:/var/lib/mysql"
    environment:
      - "MYSQL_ROOT_PASSWORD=12306A.12306A"
    image:
      mysql
  redis:
    ports:
      - "6379:6379"
    image:
      redis
  zipkin:
    ports:
      - "9410:9410/tcp"
      - "9411:9411/tcp"
    image:
      openzipkin/zipkin
  nginx:
    build:
      context: ./docker/nginx
      labels:
        - "latest"
    ports:
    - "80:80"
#  fabio:
#    build:
#      context: ./docker/fabio
#      labels:
#        - "latest"
#    ports:
#    - "9999:9999"
#    - "9998:9998"
  consul:
    build:
      context: ./docker/consul
      labels:
        - "latest"
    ports:
      - "8300:8300/tcp"
      - "8301:8301/tcp"
      - "8301:8301/udp"
      - "8302:8302/tcp"
      - "8302:8302/udp"
      - "8500:8500/tcp"
      - "8600:8600/tcp"
      - "8600:8600/udp"